{% extends "base.html" %}

{% block title %}How to Find RSS URLs for Podcasts{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h2 class="mb-0">
                        <i class="fas fa-podcast me-2"></i>
                        How to Find RSS URLs for Podcasts
                    </h2>
                </div>
                <div class="card-body">
                    <div class="alert alert-info">
                        <h5><i class="fas fa-lightbulb me-2"></i>Quick Start</h5>
                        <p class="mb-0">Do you like this episode on <strong>Spotify</strong>, <strong>Apple Podcasts</strong>, or your favorite podcast vendor? Here are the best tips to find the RSS URL you need to provide here to get the transcript of the podcast.</p>
                    </div>

                    <div class="row">
                        <!-- Apple Podcasts -->
                        <div class="col-md-6 mb-4">
                            <div class="card h-100 border-success">
                                <div class="card-header bg-success text-white">
                                    <h5 class="mb-0"><i class="fab fa-apple me-2"></i>Apple Podcasts</h5>
                                </div>
                                <div class="card-body">
                                    <ol class="mb-3">
                                        <li>Open <strong>Apple Podcasts</strong> app or visit <a href="https://podcasts.apple.com" target="_blank" class="text-success">podcasts.apple.com</a></li>
                                        <li>Search for the podcast you want</li>
                                        <li>Click on the podcast to open its page</li>
                                        <li>Look for the <strong>"Share"</strong> button (square with arrow)</li>
                                        <li>Select <strong>"Copy Link"</strong></li>
                                        <li>Paste the URL below and click <strong>"Convert to RSS"</strong></li>
                                    </ol>
                                    
                                    <!-- Apple Podcasts URL Converter -->
                                    <div class="card border-primary">
                                        <div class="card-header bg-primary text-white py-2">
                                            <h6 class="mb-0"><i class="fas fa-magic me-2"></i>Convert Apple Podcasts URL</h6>
                                        </div>
                                        <div class="card-body p-3">
                                            <div class="input-group mb-2">
                                                <input type="text" id="appleUrlInput" class="form-control form-control-sm" 
                                                       placeholder="https://podcasts.apple.com/us/podcast/..." 
                                                       value="https://podcasts.apple.com/us/podcast/ness/id1766283329">
                                                <button class="btn btn-primary btn-sm" type="button" onclick="convertAppleUrl()">
                                                    <i class="fas fa-magic me-1"></i>Convert
                                                </button>
                                            </div>
                                            <div id="conversionResult" class="mt-2" style="display: none;"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Spotify -->
                        <div class="col-md-6 mb-4">
                            <div class="card h-100 border-success">
                                <div class="card-header bg-success text-white">
                                    <h5 class="mb-0"><i class="fab fa-spotify me-2"></i>Spotify</h5>
                                </div>
                                <div class="card-body">
                                    <ol class="mb-3">
                                        <li>Open <strong>Spotify</strong> app or visit <a href="https://open.spotify.com" target="_blank" class="text-success">open.spotify.com</a></li>
                                        <li>Search for the podcast</li>
                                        <li>Click on the podcast to open its page</li>
                                        <li>Click the <strong>"..."</strong> (three dots) menu</li>
                                        <li>Select <strong>"Share"</strong> → <strong>"Copy link to playlist"</strong></li>
                                        <li>Use the copied URL as your RSS URL</li>
                                    </ol>
                                    <div class="alert alert-warning">
                                        <small><strong>Note:</strong> Spotify URLs are not RSS feeds. You need to find the original RSS feed.</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <!-- Google Podcasts -->
                        <div class="col-md-6 mb-4">
                            <div class="card h-100 border-info">
                                <div class="card-header bg-info text-white">
                                    <h5 class="mb-0"><i class="fab fa-google me-2"></i>Google Podcasts</h5>
                                </div>
                                <div class="card-body">
                                    <ol class="mb-3">
                                        <li>Visit <a href="https://podcasts.google.com" target="_blank" class="text-info">podcasts.google.com</a></li>
                                        <li>Search for the podcast</li>
                                        <li>Click on the podcast</li>
                                        <li>Copy the URL from your browser's address bar</li>
                                        <li>Use this URL as your RSS feed</li>
                                    </ol>
                                    <div class="alert alert-warning">
                                        <small><strong>Note:</strong> Google Podcasts URLs are not RSS feeds. You need to find the original RSS feed.</small>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Generic Method -->
                        <div class="col-md-6 mb-4">
                            <div class="card h-100 border-warning">
                                <div class="card-header bg-warning text-dark">
                                    <h5 class="mb-0"><i class="fas fa-search me-2"></i>Generic Method</h5>
                                </div>
                                <div class="card-body">
                                    <ol class="mb-3">
                                        <li>Visit the podcast's <strong>official website</strong></li>
                                        <li>Look for <strong>"RSS"</strong>, <strong>"Feed"</strong>, or <strong>"Subscribe"</strong> links</li>
                                        <li>Right-click on the RSS link and <strong>"Copy link address"</strong></li>
                                        <li>Use the copied URL (usually ends with <code>.rss</code> or <code>.xml</code>)</li>
                                    </ol>
                                    <div class="alert alert-info">
                                        <small><strong>For Apple Podcasts URLs:</strong> Visit the podcast's official website to find the RSS feed, or search for "<em>podcast name</em> RSS feed" on Google.</small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Advanced Tips -->
                    <div class="card border-primary mt-4">
                        <div class="card-header bg-primary text-white">
                            <h5 class="mb-0"><i class="fas fa-star me-2"></i>Pro Tips</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <h6><i class="fas fa-check-circle text-success me-2"></i>What Works:</h6>
                                    <ul class="list-unstyled">
                                        <li>• <strong>Direct RSS feeds</strong> - Always work (ends with .rss or .xml)</li>
                                        <li>• <strong>Apple Podcasts URLs</strong> - Use our converter above!</li>
                                        <li>• <strong>Podcast website RSS links</strong> - Usually work</li>
                                        <li>• <strong>Simplecast, Anchor, etc.</strong> - RSS hosting services</li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <h6><i class="fas fa-exclamation-triangle text-warning me-2"></i>What Doesn't Work:</h6>
                                    <ul class="list-unstyled">
                                        <li>• Spotify URLs (open.spotify.com)</li>
                                        <li>• YouTube podcast URLs</li>
                                        <li>• Google Podcasts URLs</li>
                                        <li>• Social media links</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Examples -->
                    <div class="card border-secondary mt-4">
                        <div class="card-header bg-secondary text-white">
                            <h5 class="mb-0"><i class="fas fa-code me-2"></i>Example URLs</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <h6>✅ Good Examples (RSS Feeds):</h6>
                                    <ul class="list-unstyled">
                                        <li><code>https://feeds.simplecast.com/abc123</code></li>
                                        <li><code>https://podcast.example.com/rss.xml</code></li>
                                        <li><code>https://anchor.fm/s/123456/podcast/rss</code></li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <h6>❌ Won't Work (Not RSS):</h6>
                                    <ul class="list-unstyled">
                                        <li><code>https://podcasts.apple.com/us/podcast/podcast-name/id123456789</code></li>
                                        <li><code>https://open.spotify.com/show/abc123</code></li>
                                        <li><code>https://www.youtube.com/watch?v=abc123</code></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Back to App -->
                    <div class="text-center mt-4">
                        <a href="/" class="btn btn-primary btn-lg">
                            <i class="fas fa-arrow-left me-2"></i>
                            Back to Podcast Transcriber
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
function convertAppleUrl() {
    const input = document.getElementById('appleUrlInput');
    const resultDiv = document.getElementById('conversionResult');
    const url = input.value.trim();
    
    if (!url) {
        showResult('Please enter an Apple Podcasts URL', 'warning');
        return;
    }
    
    if (!url.includes('podcasts.apple.com')) {
        showResult('Please enter a valid Apple Podcasts URL', 'danger');
        return;
    }
    
    // Show loading
    showResult('Converting...', 'info', true);
    
    // Make API call
    fetch('/convert-apple-url', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({ apple_url: url })
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            showResult(`
                <div class="alert alert-success">
                    <h6><i class="fas fa-check-circle me-2"></i>Success!</h6>
                    <p class="mb-2">RSS Feed URL:</p>
                    <div class="input-group">
                        <input type="text" class="form-control" value="${data.rss_url}" readonly>
                        <button class="btn btn-outline-secondary" type="button" onclick="copyToClipboard('${data.rss_url}')">
                            <i class="fas fa-copy"></i>
                        </button>
                    </div>
                    <small class="text-muted mt-2 d-block">Copy this RSS URL and use it in the main transcriber!</small>
                </div>
            `, 'success');
        } else {
            showResult(`<div class="alert alert-danger"><i class="fas fa-exclamation-triangle me-2"></i>Error: ${data.error}</div>`, 'danger');
        }
    })
    .catch(error => {
        showResult(`<div class="alert alert-danger"><i class="fas fa-exclamation-triangle me-2"></i>Error: ${error.message}</div>`, 'danger');
    });
}

function showResult(message, type, isLoading = false) {
    const resultDiv = document.getElementById('conversionResult');
    resultDiv.innerHTML = message;
    resultDiv.className = `mt-2 ${isLoading ? 'text-info' : ''}`;
    resultDiv.style.display = 'block';
}

function copyToClipboard(text) {
    navigator.clipboard.writeText(text).then(() => {
        // Show success message
        const button = event.target.closest('button');
        const originalHTML = button.innerHTML;
        button.innerHTML = '<i class="fas fa-check"></i>';
        button.classList.remove('btn-outline-secondary');
        button.classList.add('btn-success');
        
        setTimeout(() => {
            button.innerHTML = originalHTML;
            button.classList.remove('btn-success');
            button.classList.add('btn-outline-secondary');
        }, 2000);
    });
}
</script>

{% endblock %}
